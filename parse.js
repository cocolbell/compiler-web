!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e=n();for(var o in e)("object"==typeof exports?exports:t)[o]=e[o]}}(this,(function(){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=9)}({1:function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.d(n,"c",(function(){return b})),e.d(n,"d",(function(){return O})),e.d(n,"a",(function(){return o})),e.d(n,"e",(function(){return r})),e.d(n,"b",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=e(2);function f(t){let n=t;n._exe||(n._exe=function(e,i,r,u){if(!g())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const e=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}E.debug&&E.debug.stepTime,s._exe(e,i,r,u)})}function p(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{f(t)}),t._exe=function(i,u,s,c){if(!g())return;I.execute&&I.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=n._scopeManager.getCurrentScope(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=n._scopeManager.getCurrentScope(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p){if(!1===p.exe(u,c))return}const a=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)if(t.proxyPin&&t.proxyPin._exe){t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction)}else t.parent._exe(f,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;a&&(void 0!==n?a(JSON.parse(t.mockData)):i=function(t){a(t)}),e._exe(f,u,i,t)})}}}function a(t,n,e="runtime"){i.each(t=>p(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>p(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(!function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{m(t,n)})}let d=new WeakMap;function l(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?f(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?f(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`);t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=d.get(t);n||d.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function h(){let t;function n(n,e,o){let i=t[n];i||(t[n]=i={}),i[e]=o}return{applyScope(t,e){const o=function t(e,o,i,r){let s={id:u(),instId:o,hostId:i,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,o,i,r){const u=t(s,e,i,r);let c=s.comInsts[e];return c&&(!c.scopes&&(c.scopes=[]),c.scopes.push(u)),n(e,i,u),u}};if(r)s.path=s.id;else{const t=[s.id];let n=s.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;s.path=t.reverse().join(":")}return s}(void 0,t,e);return n(t,e,o),o},getCurrentScope(n,e){var o;return null===(o=t[n])||void 0===o?void 0:o[e]},start(){t={}},stop(){t={}}}}function m(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{a(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>p(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>p(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>l(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>l(t,n,e));const o=t,i={};o._startScope=function(){this._scopeManager=h(),this._scopeManager.start()},o._clearScope=function(){this._scopeManager&&(this._scopeManager.stop(),this._scopeManager=void 0)},o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(a(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,p){if(!r){if(t.parent){const n=o._scopeManager.getCurrentScope(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=o._scopeManager.applyScope(void 0,t.id+"-parent"))}const l=c+r.id;let h=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(h=!0)}if(!i[l]||h){let u,d;if(o._exeAsRoot_=!!p,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const h=[];"input"==(f="string"==typeof f?f:"input")&&(d=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{h.push(t.runtime.id),"function"!=typeof t._exe&&a(t,n,e),t._exe(d,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:d,coms:h}}const{curScope:m}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(m,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=d.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,m)}),m}if(f.match(/^(output)|(inner-input)$/gi)){let n=m;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let _,y,x,P=null;let v="stop";function g(){return"running"===v}let E={},I={};function b(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),m(t,n,e),P={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(I[t.toLowerCase()]=n)},run(n=t,e){if(n._startScope(),function(t){return Object.assign(E,t||{}),y=[],x=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){I.error?I.error(t):console.error(t)}n(_)}function n(e){if("stop"==v||e!==_)return;let o;if("pause"==v&&setTimeout(n,1e3),x.length>0?o=x.shift():y.length>0&&(o=y.shift()),o){E.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o)}else setTimeout(t=>n(e))}v="running",_=u(),n(_),new Promise((t,n)=>{})}(),t=>{t&&t.outputs&&n.outputPins&&n.outputPins.forEach(n=>{const e=t.outputs[n.id];"function"==typeof e&&(n.proxyPin={_exe(t,n,o,i){e(n)}})});const e=n._exe(void 0,null==t?void 0:t.inputParams,void 0,"input",!0);return t.inputs&&n.inputPins&&Object.keys(t.inputs).forEach(e=>{const o=t.inputs[e],i=n.inputPins.find(t=>t.id===e);i&&i.conAry.length>0&&o(t=>{i._exe(void 0,t,void 0,void 0)})}),e}},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:w,stop(){const n=(v="stop",!0);return P=null,y=void 0,x=void 0,t._clearScope(),n}}}function w(){return v="pause",!0}function O(t,n){const e={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:"_setInterseptor"===n?t[n]:function(t){if(r){const e=r[n];"function"==typeof e&&e(t)}e.set(n,(function(e){const o=s[n];if(void 0!==e&&o){s[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=e.get(o);return u?((null==n?void 0:n.input)&&n.input(),u(i)):e.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return e[r];let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},f=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!f)throw new Error(`No output(hostId=${r}) found.`);if((null==n?void 0:n.output)&&n.output(e),c){const t=c[r];"function"==typeof t&&t(e)}f._exe(null,e,u,t)}}}})}}},2:function(t,n,e){t.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){t.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){t.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){t.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){t.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){t.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.r(n),e.d(n,"T_Scope",(function(){})),e.d(n,"compile",(function(){return O})),e.d(n,"createIO",(function(){return N})),e.d(n,"E_ItemType",(function(){return o})),e.d(n,"isTypeof",(function(){return r})),e.d(n,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";function c(t){let n=t;n._exe||(n._exe=function(e,i,u,s){if(!I())return;const c=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof c._exe){const e=r(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}b.debug&&b.debug.stepTime,c._exe(e,i,u,s)})}let f;function p(t,n){const e=function t(n,e,o,i){let r={id:u(),instId:e,hostId:o,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,e,o,i){const u=t(r,n,o,i);let s=r.comInsts[n];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),d(n,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let n=r.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;r.path=t.reverse().join(":")}return r}(void 0,t,n);return d(t,n,e),e}function a(t,n){var e;return null===(e=f[t])||void 0===e?void 0:e[n]}function d(t,n,e){let o=f[t];o||(f[t]=o={}),o[n]=e}function l(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{c(t)}),t._exe=function(i,u,s,c){if(!I())return;w.execute&&w.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=a(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=a(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p&&!1===p.exe(u,c))return;const d=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction):t.parent._exe(f,void 0,{[t.hostId]:u},d);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,d,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,d,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;d&&(void 0!==n?d(JSON.parse(t.mockData)):i=function(t){d(t)}),e._exe(f,u,i,t)})}}}function h(t,n,e="runtime"){i.each(t=>l(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>l(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{y(t,n)})}let m=new WeakMap;function _(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?c(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?c(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=m.get(t);n||m.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function y(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{h(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>l(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>l(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>_(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>_(t,n,e));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(h(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,d){if(!r){if(t.parent){const n=a(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=p(void 0,t.id+"-parent"))}const l=c+r.id;let _=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(_=!0)}if(!i[l]||_){let u,p;if(o._exeAsRoot_=!!d,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const a=[];"input"==(f="string"==typeof f?f:"input")&&(p=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{a.push(t.runtime.id),"function"!=typeof t._exe&&h(t,n,e),t._exe(p,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:p,coms:a}}const{curScope:y}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(y,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=m.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,y)}),y}if(f.match(/^(output)|(inner-input)$/gi)){let n=y;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let x,P,v,g=null,E="stop";function I(){return"running"===E}let b={},w={};function O(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),y(t,n,e),g={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(w[t.toLowerCase()]=n)},run(n=t,e){if("stop"===E&&(f={}),function(t){return Object.assign(b,t||{}),P=[],v=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){w.error?w.error(t):console.error(t)}n(x)}function n(e){if("stop"==E||e!==x)return;let o;"pause"==E&&setTimeout(n,1e3),v.length>0?o=v.shift():P.length>0&&(o=P.shift()),o?b.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>n(e))}E="running",x=u(),n(x),new Promise((t,n)=>{})}(),t=>n._exe(void 0,t,void 0,"input",!0)},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:A,stop(){const t=(E="stop",!0);return g=null,P=void 0,v=void 0,f={},t}}}function A(){return E="pause",!0}function N(t,n){const e={_all:{},_waiting:{},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u(),r={};return{inputs:new Proxy({},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:function(t){e.set(n,(function(e){const o=r[n];if(void 0!==e&&o){r[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,u){r[o]=i;const s=e.get(o);return s?((null==n?void 0:n.input)&&n.input(),s(i)):e.waiting(o,i),!0}}),outputs:new Proxy({},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},c=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!c)throw new Error(`No output(hostId=${r}) found.`);Promise.resolve().then(()=>{(null==n?void 0:n.output)&&n.output(e),c._exe(null,e,u,t)})}}}})}}}])},function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.r(n),e.d(n,"T_Scope",(function(){})),e.d(n,"compile",(function(){return A})),e.d(n,"createIO",(function(){return M})),e.d(n,"E_ItemType",(function(){return o})),e.d(n,"isTypeof",(function(){return r})),e.d(n,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=e(0);function f(t){let n=t;n._exe||(n._exe=function(e,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const e=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(e,i,r,u)})}let p;function a(t,n){const e=function t(n,e,o,i){let r={id:u(),instId:e,hostId:o,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,e,o,i){const u=t(r,n,o,i);let s=r.comInsts[n];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(n,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let n=r.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;r.path=t.reverse().join(":")}return r}(void 0,t,n);return l(t,n,e),e}function d(t,n){var e;return null===(e=p[t])||void 0===e?void 0:e[n]}function l(t,n,e){let o=p[t];o||(p[t]=o={}),o[n]=e}function h(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{f(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p&&!1===p.exe(u,c))return;const a=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction):t.parent._exe(f,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;a&&(void 0!==n?a(JSON.parse(t.mockData)):i=function(t){a(t)}),e._exe(f,u,i,t)})}}}function m(t,n,e="runtime"){i.each(t=>h(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>h(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,n)})}let _=new WeakMap;function y(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?f(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?f(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=_.get(t);n||_.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function x(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{m(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>h(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>h(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>y(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>y(t,n,e));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(m(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,p){if(!r){if(t.parent){const n=d(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let h=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(h=!0)}if(!i[l]||h){let u,a;if(o._exeAsRoot_=!!p,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(f="string"==typeof f?f:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&m(t,n,e),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:y}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(y,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=_.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,y)}),y}if(f.match(/^(output)|(inner-input)$/gi)){let n=y;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let P,v,g,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),x(t,n,e),E={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(O[t.toLowerCase()]=n)},run(n=t,e){if("stop"===I&&(p={}),function(t){return Object.assign(w,t||{}),v=[],g=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}n(P)}function n(e){if("stop"==I||e!==P)return;let o;"pause"==I&&setTimeout(n,1e3),g.length>0?o=g.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>n(e))}I="running",P=u(),n(P),new Promise((t,n)=>{})}(),t=>n._exe(void 0,t,void 0,"input",!0)},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,g=void 0,p={},t}}}function N(){return I="pause",!0}function M(t,n){const e={_all:{},_waiting:{},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u(),r={};return{inputs:new Proxy({},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:function(t){e.set(n,(function(e){const o=r[n];if(void 0!==e&&o){r[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,u){r[o]=i;const s=e.get(o);return s?((null==n?void 0:n.input)&&n.input(),s(i)):e.waiting(o,i),!0}}),outputs:new Proxy({},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},c=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!c)throw new Error(`No output(hostId=${r}) found.`);Promise.resolve().then(()=>{(null==n?void 0:n.output)&&n.output(e),c._exe(null,e,u,t)})}}}})}}}])},function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.r(n),e.d(n,"T_Scope",(function(){})),e.d(n,"compile",(function(){return A})),e.d(n,"createIO",(function(){return M})),e.d(n,"E_ItemType",(function(){return o})),e.d(n,"isTypeof",(function(){return r})),e.d(n,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=e(0);function f(t){let n=t;n._exe||(n._exe=function(e,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const e=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(e,i,r,u)})}let p;function a(t,n){const e=function t(n,e,o,i){let r={id:u(),instId:e,hostId:o,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,e,o,i){const u=t(r,n,o,i);let s=r.comInsts[n];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(n,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let n=r.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;r.path=t.reverse().join(":")}return r}(void 0,t,n);return l(t,n,e),e}function d(t,n){var e;return null===(e=p[t])||void 0===e?void 0:e[n]}function l(t,n,e){let o=p[t];o||(p[t]=o={}),o[n]=e}function h(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{f(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p&&!1===p.exe(u,c))return;const a=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction):t.parent._exe(f,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;a&&(void 0!==n?a(JSON.parse(t.mockData)):i=function(t){a(t)}),e._exe(f,u,i,t)})}}}function m(t,n,e="runtime"){i.each(t=>h(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>h(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,n)})}let _=new WeakMap;function y(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?f(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?f(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=_.get(t);n||_.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function x(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{m(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>h(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>h(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>y(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>y(t,n,e));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(m(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,p){if(!r){if(t.parent){const n=d(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let h=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(h=!0)}if(!i[l]||h){let u,a;if(o._exeAsRoot_=!!p,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(f="string"==typeof f?f:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&m(t,n,e),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:y}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(y,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=_.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,y)}),y}if(f.match(/^(output)|(inner-input)$/gi)){let n=y;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let P,v,g,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),x(t,n,e),E={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(O[t.toLowerCase()]=n)},run(n=t,e){if("stop"===I&&(p={}),function(t){return Object.assign(w,t||{}),v=[],g=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}n(P)}function n(e){if("stop"==I||e!==P)return;let o;"pause"==I&&setTimeout(n,1e3),g.length>0?o=g.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>n(e))}I="running",P=u(),n(P),new Promise((t,n)=>{})}(),t=>n._exe(void 0,t,void 0,"input",!0)},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,g=void 0,p={},t}}}function N(){return I="pause",!0}function M(t,n){const e={_all:{},_waiting:{},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u(),r={};return{inputs:new Proxy({},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:function(t){e.set(n,(function(e){const o=r[n];if(void 0!==e&&o){r[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,u){r[o]=i;const s=e.get(o);return s?((null==n?void 0:n.input)&&n.input(),s(i)):e.waiting(o,i),!0}}),outputs:new Proxy({},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},c=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!c)throw new Error(`No output(hostId=${r}) found.`);Promise.resolve().then(()=>{(null==n?void 0:n.output)&&n.output(e),c._exe(null,e,u,t)})}}}})}}}])},function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.r(n),e.d(n,"T_Scope",(function(){})),e.d(n,"compile",(function(){return A})),e.d(n,"createIO",(function(){return M})),e.d(n,"E_ItemType",(function(){return o})),e.d(n,"isTypeof",(function(){return r})),e.d(n,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=e(0);function f(t){let n=t;n._exe||(n._exe=function(e,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const e=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(e,i,r,u)})}let p;function a(t,n){const e=function t(n,e,o,i){let r={id:u(),instId:e,hostId:o,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,e,o,i){const u=t(r,n,o,i);let s=r.comInsts[n];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(n,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let n=r.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;r.path=t.reverse().join(":")}return r}(void 0,t,n);return l(t,n,e),e}function d(t,n){var e;return null===(e=p[t])||void 0===e?void 0:e[n]}function l(t,n,e){let o=p[t];o||(p[t]=o={}),o[n]=e}function h(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{f(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p&&!1===p.exe(u,c))return;const a=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction):t.parent._exe(f,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;a&&(void 0!==n?a(JSON.parse(t.mockData)):i=function(t){a(t)}),e._exe(f,u,i,t)})}}}function m(t,n,e="runtime"){i.each(t=>h(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>h(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,n)})}let _=new WeakMap;function y(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?f(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?f(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=_.get(t);n||_.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function x(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{m(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>h(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>h(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>y(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>y(t,n,e));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(m(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,p){if(!r){if(t.parent){const n=d(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let h=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(h=!0)}if(!i[l]||h){let u,a;if(o._exeAsRoot_=!!p,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(f="string"==typeof f?f:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&m(t,n,e),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:y}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(y,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=_.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,y)}),y}if(f.match(/^(output)|(inner-input)$/gi)){let n=y;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let P,v,g,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),x(t,n,e),E={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(O[t.toLowerCase()]=n)},run(n=t,e){if("stop"===I&&(p={}),function(t){return Object.assign(w,t||{}),v=[],g=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}n(P)}function n(e){if("stop"==I||e!==P)return;let o;"pause"==I&&setTimeout(n,1e3),g.length>0?o=g.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>n(e))}I="running",P=u(),n(P),new Promise((t,n)=>{})}(),t=>n._exe(void 0,t,void 0,"input",!0)},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,g=void 0,p={},t}}}function N(){return I="pause",!0}function M(t,n){const e={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:"_setInterseptor"===n?t[n]:function(t){if(r){const e=r[n];"function"==typeof e&&e(t)}e.set(n,(function(e){const o=s[n];if(void 0!==e&&o){s[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=e.get(o);return u?((null==n?void 0:n.input)&&n.input(),u(i)):e.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return e[r];let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},f=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!f)throw new Error(`No output(hostId=${r}) found.`);if((null==n?void 0:n.output)&&n.output(e),c){const t=c[r];"function"==typeof t&&t(e)}f._exe(null,e,u,t)}}}})}}}])},function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.r(n),e.d(n,"T_Scope",(function(){})),e.d(n,"compile",(function(){return A})),e.d(n,"createIO",(function(){return M})),e.d(n,"E_ItemType",(function(){return o})),e.d(n,"isTypeof",(function(){return r})),e.d(n,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=e(0);function f(t){let n=t;n._exe||(n._exe=function(e,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const e=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(e,i,r,u)})}let p;function a(t,n){const e=function t(n,e,o,i){let r={id:u(),instId:e,hostId:o,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,e,o,i){const u=t(r,n,o,i);let s=r.comInsts[n];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(n,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let n=r.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;r.path=t.reverse().join(":")}return r}(void 0,t,n);return l(t,n,e),e}function d(t,n){var e;return null===(e=p[t])||void 0===e?void 0:e[n]}function l(t,n,e){let o=p[t];o||(p[t]=o={}),o[n]=e}function h(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{f(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p&&!1===p.exe(u,c))return;const a=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction):t.parent._exe(f,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;a&&(void 0!==n?a(JSON.parse(t.mockData)):i=function(t){a(t)}),e._exe(f,u,i,t)})}}}function m(t,n,e="runtime"){i.each(t=>h(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>h(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,n)})}let _=new WeakMap;function y(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?f(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?f(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=_.get(t);n||_.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function x(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{m(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>h(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>h(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>y(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>y(t,n,e));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(m(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,p){if(!r){if(t.parent){const n=d(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let h=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(h=!0)}if(!i[l]||h){let u,a;if(o._exeAsRoot_=!!p,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(f="string"==typeof f?f:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&m(t,n,e),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:y}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(y,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=_.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,y)}),y}if(f.match(/^(output)|(inner-input)$/gi)){let n=y;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let P,v,g,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),x(t,n,e),E={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(O[t.toLowerCase()]=n)},run(n=t,e){if("stop"===I&&(p={}),function(t){return Object.assign(w,t||{}),v=[],g=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}n(P)}function n(e){if("stop"==I||e!==P)return;let o;"pause"==I&&setTimeout(n,1e3),g.length>0?o=g.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>n(e))}I="running",P=u(),n(P),new Promise((t,n)=>{})}(),t=>(t&&(t.inputProxies&&n.inputPins&&Object.keys(t.inputProxies).forEach(e=>{(0,t.inputProxies[e])(t=>{const o=n.inputPins.find(t=>t.id===e);o&&o._exe(void 0,t,void 0,void 0)})}),t.outputProxies&&n.outputPins&&n.outputPins.forEach(n=>{const e=t.outputProxies[n.id];"function"==typeof e&&(n.proxyPin={_exe(t,n,o,i){e(n)}})})),n._exe(void 0,null==t?void 0:t.inputParams,void 0,"input",!0))},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,g=void 0,p={},t}}}function N(){return I="pause",!0}function M(t,n){const e={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:"_setInterseptor"===n?t[n]:function(t){if(r){const e=r[n];"function"==typeof e&&e(t)}e.set(n,(function(e){const o=s[n];if(void 0!==e&&o){s[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=e.get(o);return u?((null==n?void 0:n.input)&&n.input(),u(i)):e.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return e[r];let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},f=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!f)throw new Error(`No output(hostId=${r}) found.`);if((null==n?void 0:n.output)&&n.output(e),c){const t=c[r];"function"==typeof t&&t(e)}f._exe(null,e,u,t)}}}})}}}])},function(t,n,e){"use strict";var o,i;function r(t,n){return t&&"object"==typeof t&&t._type==n}function u(){let t="abcdefhijkmnprstwxyz",n=t.length,e="";for(let o=0;o<6;o++)e+=t.charAt(Math.floor(Math.random()*n));return"u_"+e}e.r(n),e.d(n,"T_Scope",(function(){})),e.d(n,"compile",(function(){return A})),e.d(n,"createIO",(function(){return M})),e.d(n,"E_ItemType",(function(){return o})),e.d(n,"isTypeof",(function(){return r})),e.d(n,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...n){n.forEach(n=>{n&&n.forEach(t)})},t.find=function(t,...n){let e;return n.find(n=>{if(n)return e=n.find(n=>t(n))}),e}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=e(0);function f(t){let n=t;n._exe||(n._exe=function(e,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const e=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${e?e.runtime.title:"未知组件"}，${n.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(e,i,r,u)})}let p;function a(t,n){const e=function t(n,e,o,i){let r={id:u(),instId:e,hostId:o,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,e,o,i){const u=t(r,n,o,i);let s=r.comInsts[n];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(n,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let n=r.parent;for(;n;)n.parent&&t.push(n.id),n=n.parent;r.path=t.reverse().join(":")}return r}(void 0,t,n);return l(t,n,e),e}function d(t,n){var e;return null===(e=p[t])||void 0===e?void 0:e[n]}function l(t,n,e){let o=p[t];o||(p[t]=o={}),o[n]=e}function h(t,n,e="runtime"){t.conAry&&t.conAry.forEach(t=>{f(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let f=i;if(!f)if(r(t.parent,o.NODE)){const n=t.parent.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}else if(r(t.parent,o.FRAME)){const n=t.parent;f=d(!n._exeAsRoot_&&n.parent?n.parent.runtime.id:void 0,n.id)}let p=n.pin?n.pin(t):void 0;if(p&&!1===p.exe(u,c))return;const a=n=>{p&&p.exe(n,t,"返回"),"function"==typeof s&&s(n)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(f,{[t.hostId]:u},void 0,t.direction):t.parent._exe(f,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(f.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let n;"mock"===e&&t.mockData&&(n=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((e,o)=>{let i;a&&(void 0!==n?a(JSON.parse(t.mockData)):i=function(t){a(t)}),e._exe(f,u,i,t)})}}}function m(t,n,e="runtime"){i.each(t=>h(t,n,e),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>h(t,n,e),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=n.node(t),u={};o._exe=function(n,e,o,c){let f;i.each(t=>{void 0!==t.dummyData&&(!f&&(f={}),f[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=f?Object.assign(f,o):o,u[n.id]||(function(n,e=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=n.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(e,o=s){const i=t._exe(n,e,o);if(i)return i.path}});const u={inst:r.render(o,e,i,n),scopes:[]};n.comInsts[t.runtime.id]=u}(n,e),u[n.id]=!0);const p=n.comInsts[t.runtime.id];if(o)for(let t in o){const n=o[t];p.inst.inputs[t]=[n,c]}r.exe&&r.exe(p.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,n)})}let _=new WeakMap;function y(t,n,e="runtime"){const o=t.parent.parent.runtime;t.from?f(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?f(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(e,o,i){const r=n.joint?n.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let n=e.comInsts[u.runtime.id].scopes.find(n=>n.hostId===t.parent.id);const s=n=>{r&&r.exe(o),t.to&&t.to._exe(n,o,i,t.type)};if(n){let t=n.hostId;n.parent.comInsts[u.runtime.id].scopes.forEach(n=>{n.hostId==t&&s(n)})}else{let n=_.get(t);n||_.set(t,n=new WeakMap);let o=n.get(e);o||n.set(e,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(e.parent,o,i,t.type)}}function x(t,n,e="runtime"){t.comAry&&t.comAry.forEach(t=>{m(t,n,e)}),t.inputPins&&t.inputPins.forEach(t=>h(t,n,e)),t.outputPins&&t.outputPins.forEach(t=>h(t,n,e)),t.inputJoints&&t.inputJoints.forEach(t=>y(t,n,e)),t.outputJoints&&t.outputJoints.forEach(t=>y(t,n,e));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:f,coms:p}=i[c];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(m(t,n,e),t._exe(f,u,void 0,void 0))})},o._exe=function(r,u,c=s,f,p){if(!r){if(t.parent){const n=d(t.parent?t.parent.runtime.id:t.id,t.id);n&&(r=n.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let h=!1;if(i[l]){const n=i[l].coms;(n.length!==t.comAry.length||t.comAry.find(t=>n.indexOf(t.runtime.id)<0))&&(h=!0)}if(!i[l]||h){let u,a;if(o._exeAsRoot_=!!p,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(f="string"==typeof f?f:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&m(t,n,e),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:y}=i[l];if("input"==(f="string"==typeof f?f:"input")){const n={};if("mock"===e&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(n[t.hostId]=t.mockData)}),u=Object.assign(n,u))for(let n in u){const e=t.inputPins.find(t=>t.hostId==n);e?e._exe(y,u[n],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${n}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,n){let e=n.parent,o=_.get(t);if(o){let t=o.get(e);t&&t.forEach(t=>{t(n)})}}(t,y)}),y}if(f.match(/^(output)|(inner-input)$/gi)){let n=y;if(t.outputPins.length){if(u)for(let t in u)n.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==n.returnParams[t.hostId])||n.resolve()}}}}let P,v,g,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,n,e="runtime"){return function(t,n){if(!r(t,n))throw new Error("Invalid item type")}(t,o.FRAME),x(t,n,e),E={on(t,n){t&&"string"==typeof t&&"function"==typeof n&&(O[t.toLowerCase()]=n)},run(n=t,e){if("stop"===I&&(p={}),function(t){return Object.assign(w,t||{}),v=[],g=[],!0}(e))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}n(P)}function n(e){if("stop"==I||e!==P)return;let o;"pause"==I&&setTimeout(n,1e3),g.length>0?o=g.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>n(e))}I="running",P=u(),n(P),new Promise((t,n)=>{})}(),t=>(t&&(t.inputs&&n.inputPins&&Object.keys(t.inputs).forEach(e=>{(0,t.inputs[e])(t=>{const o=n.inputPins.find(t=>t.id===e);o&&o._exe(void 0,t,void 0,void 0)})}),t.outputs&&n.outputPins&&n.outputPins.forEach(n=>{const e=t.outputs[n.id];"function"==typeof e&&(n.proxyPin={_exe(t,n,o,i){e(n)}})})),n._exe(void 0,null==t?void 0:t.inputParams,void 0,"input",!0))},update:(n,e=t)=>(e._update(n,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,g=void 0,p={},t}}}function N(){return I="pause",!0}function M(t,n){const e={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,n){this._all[t]=n;const e=this._waiting[t];if(e)try{e.forEach(t=>{n(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,n){let e=this._waiting[t];e||(e=this._waiting[t]=[]),e.push(n)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.inputPins,t.inputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,n,i)=>"__id__"===n?o:"_setInterseptor"===n?t[n]:function(t){if(r){const e=r[n];"function"==typeof e&&e(t)}e.set(n,(function(e){const o=s[n];if(void 0!==e&&o){s[n]=void 0;const[o,i]=e;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=e.get(o);return u?((null==n?void 0:n.input)&&n.input(),u(i)):e.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(n){const e=[];return i.each(t=>{e.push(t.hostId)},t.outputPins,t.outputPinsInModel),e},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(e,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return e[r];let s;return function(e,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},f=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!f)throw new Error(`No output(hostId=${r}) found.`);if((null==n?void 0:n.output)&&n.output(e),c){const t=c[r];"function"==typeof t&&t(e)}f._exe(null,e,u,t)}}}})}}}])},9:function(t,n,e){"use strict";e.r(n),e.d(n,"parse",(function(){return s}));var o=e(1);let i,r,u;function s(t){const n=JSON.parse(JSON.stringify(t));u=new WeakMap,r={};const e=n["xg.desn.stageview"],{def:s,refs:f}=e;i=f;const p=[],a=c(s._ref_).mainModule;if(a.frame){!function t(n){n.comAry&&n.comAry.forEach(n=>{if(Object(o.e)(n,o.a.NODE)){const{runtime:e}=n,o=e.def.namespace+"@"+e.def.version;p.indexOf(o)<=0&&p.push(o),n.frames&&n.frames.forEach(n=>t(n))}})}(a.frame)}return i=void 0,r=void 0,u=void 0,{mainModule:a,requireComs:p}}function c(t){let n=r[t];return n||(r[t]=n=i[t],function t(n){if(n&&u.has(n))return u.get(n);if("object"==typeof n&&n){let e;return n._ref_?(e=c(n._ref_),u.set(n,e)):(u.set(n,n),Object.keys(n).forEach(e=>{let o=n[e];Array.isArray(o)?o.forEach((n,e)=>{o[e]=t(n)}):n[e]=t(o)}),e=n),e}return n}(n),n)}}})}));
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@mybricks/rxui"),require("react")):"function"==typeof define&&define.amd?define(["@mybricks/rxui","react"],e):"object"==typeof exports?exports.xgCompilerWeb=e(require("@mybricks/rxui"),require("react")):t.xgCompilerWeb=e(t["@mybricks/rxui"],t.react)}(this,(function(t,e){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){var o=n(4),i=n(5);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var r={insert:"head",singleton:!1};o(i,r);t.exports=i.locals||{}},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e,n){t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"T_Scope",(function(){})),n.d(e,"compile",(function(){return O})),n.d(e,"createIO",(function(){return N})),n.d(e,"E_ItemType",(function(){return o})),n.d(e,"isTypeof",(function(){return r})),n.d(e,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";function c(t){let e=t;e._exe||(e._exe=function(n,i,u,s){if(!I())return;const c=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof c._exe){const n=r(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}b.debug&&b.debug.stepTime,c._exe(n,i,u,s)})}let p;function f(t,e){const n=function t(e,n,o,i){let r={id:u(),instId:n,hostId:o,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,n,o,i){const u=t(r,e,o,i);let s=r.comInsts[e];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),d(e,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let e=r.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;r.path=t.reverse().join(":")}return r}(void 0,t,e);return d(t,e,n),n}function a(t,e){var n;return null===(n=p[t])||void 0===n?void 0:n[e]}function d(t,e,n){let o=p[t];o||(p[t]=o={}),o[e]=n}function l(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{c(t)}),t._exe=function(i,u,s,c){if(!I())return;w.execute&&w.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=a(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=a(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f&&!1===f.exe(u,c))return;const d=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction):t.parent._exe(p,void 0,{[t.hostId]:u},d);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,d,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,d,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;d&&(void 0!==e?d(JSON.parse(t.mockData)):i=function(t){d(t)}),n._exe(p,u,i,t)})}}}function m(t,e,n="runtime"){i.each(t=>l(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>l(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,c){let p;i.each(t=>{void 0!==t.dummyData&&(!p&&(p={}),p[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=p?Object.assign(p,o):o,u[e.id]||(function(e,n=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o=s){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const f=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];f.inst.inputs[t]=[e,c]}r.exe&&r.exe(f.inst,o,c)},t.frames&&t.frames.forEach(t=>{_(t,e)})}let h=new WeakMap;function y(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?c(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?c(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=h.get(t);e||h.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function _(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{m(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>l(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>l(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>y(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>y(t,e,n));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:p,coms:f}=i[c];t.comAry.forEach(t=>{f.push(t.runtime.id),"function"!=typeof t._exe&&(m(t,e,n),t._exe(p,u,void 0,void 0))})},o._exe=function(r,u,c=s,p,d){if(!r){if(t.parent){const e=a(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=f(void 0,t.id+"-parent"))}const l=c+r.id;let y=!1;if(i[l]){const e=i[l].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(y=!0)}if(!i[l]||y){let u,f;if(o._exeAsRoot_=!!d,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const a=[];"input"==(p="string"==typeof p?p:"input")&&(f=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{a.push(t.runtime.id),"function"!=typeof t._exe&&m(t,e,n),t._exe(f,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:f,coms:a}}const{curScope:_}=i[l];if("input"==(p="string"==typeof p?p:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(_,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=h.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,_)}),_}if(p.match(/^(output)|(inner-input)$/gi)){let e=_;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let x,g,v,P=null,E="stop";function I(){return"running"===E}let b={},w={};function O(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),_(t,e,n),P={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(w[t.toLowerCase()]=e)},run(e=t,n){if("stop"===E&&(p={}),function(t){return Object.assign(b,t||{}),g=[],v=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){w.error?w.error(t):console.error(t)}e(x)}function e(n){if("stop"==E||n!==x)return;let o;"pause"==E&&setTimeout(e,1e3),v.length>0?o=v.shift():g.length>0&&(o=g.shift()),o?b.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>e(n))}E="running",x=u(),e(x),new Promise((t,e)=>{})}(),t=>e._exe(void 0,t,void 0,"input",!0)},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:A,stop(){const t=(E="stop",!0);return P=null,g=void 0,v=void 0,p={},t}}}function A(){return E="pause",!0}function N(t,e){const n={_all:{},_waiting:{},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u(),r={};return{inputs:new Proxy({},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:function(t){n.set(e,(function(n){const o=r[e];if(void 0!==n&&o){r[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,u){r[o]=i;const s=n.get(o);return s?((null==e?void 0:e.input)&&e.input(),s(i)):n.waiting(o,i),!0}}),outputs:new Proxy({},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},c=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!c)throw new Error(`No output(hostId=${r}) found.`);Promise.resolve().then(()=>{(null==e?void 0:e.output)&&e.output(n),c._exe(null,n,u,t)})}}}})}}}])},function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"T_Scope",(function(){})),n.d(e,"compile",(function(){return A})),n.d(e,"createIO",(function(){return M})),n.d(e,"E_ItemType",(function(){return o})),n.d(e,"isTypeof",(function(){return r})),n.d(e,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=n(0);function p(t){let e=t;e._exe||(e._exe=function(n,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const n=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(n,i,r,u)})}let f;function a(t,e){const n=function t(e,n,o,i){let r={id:u(),instId:n,hostId:o,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,n,o,i){const u=t(r,e,o,i);let s=r.comInsts[e];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(e,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let e=r.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;r.path=t.reverse().join(":")}return r}(void 0,t,e);return l(t,e,n),n}function d(t,e){var n;return null===(n=f[t])||void 0===n?void 0:n[e]}function l(t,e,n){let o=f[t];o||(f[t]=o={}),o[e]=n}function m(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{p(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f&&!1===f.exe(u,c))return;const a=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction):t.parent._exe(p,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;a&&(void 0!==e?a(JSON.parse(t.mockData)):i=function(t){a(t)}),n._exe(p,u,i,t)})}}}function h(t,e,n="runtime"){i.each(t=>m(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>m(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,c){let p;i.each(t=>{void 0!==t.dummyData&&(!p&&(p={}),p[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=p?Object.assign(p,o):o,u[e.id]||(function(e,n=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o=s){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const f=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];f.inst.inputs[t]=[e,c]}r.exe&&r.exe(f.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,e)})}let y=new WeakMap;function _(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?p(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?p(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=y.get(t);e||y.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function x(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{h(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>m(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>m(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>_(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>_(t,e,n));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:p,coms:f}=i[c];t.comAry.forEach(t=>{f.push(t.runtime.id),"function"!=typeof t._exe&&(h(t,e,n),t._exe(p,u,void 0,void 0))})},o._exe=function(r,u,c=s,p,f){if(!r){if(t.parent){const e=d(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let m=!1;if(i[l]){const e=i[l].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(m=!0)}if(!i[l]||m){let u,a;if(o._exeAsRoot_=!!f,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(p="string"==typeof p?p:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&h(t,e,n),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:_}=i[l];if("input"==(p="string"==typeof p?p:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(_,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=y.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,_)}),_}if(p.match(/^(output)|(inner-input)$/gi)){let e=_;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let g,v,P,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),x(t,e,n),E={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(O[t.toLowerCase()]=e)},run(e=t,n){if("stop"===I&&(f={}),function(t){return Object.assign(w,t||{}),v=[],P=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}e(g)}function e(n){if("stop"==I||n!==g)return;let o;"pause"==I&&setTimeout(e,1e3),P.length>0?o=P.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>e(n))}I="running",g=u(),e(g),new Promise((t,e)=>{})}(),t=>e._exe(void 0,t,void 0,"input",!0)},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,P=void 0,f={},t}}}function N(){return I="pause",!0}function M(t,e){const n={_all:{},_waiting:{},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u(),r={};return{inputs:new Proxy({},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:function(t){n.set(e,(function(n){const o=r[e];if(void 0!==n&&o){r[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,u){r[o]=i;const s=n.get(o);return s?((null==e?void 0:e.input)&&e.input(),s(i)):n.waiting(o,i),!0}}),outputs:new Proxy({},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},c=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!c)throw new Error(`No output(hostId=${r}) found.`);Promise.resolve().then(()=>{(null==e?void 0:e.output)&&e.output(n),c._exe(null,n,u,t)})}}}})}}}])},function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"T_Scope",(function(){})),n.d(e,"compile",(function(){return A})),n.d(e,"createIO",(function(){return M})),n.d(e,"E_ItemType",(function(){return o})),n.d(e,"isTypeof",(function(){return r})),n.d(e,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=n(0);function p(t){let e=t;e._exe||(e._exe=function(n,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const n=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(n,i,r,u)})}let f;function a(t,e){const n=function t(e,n,o,i){let r={id:u(),instId:n,hostId:o,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,n,o,i){const u=t(r,e,o,i);let s=r.comInsts[e];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(e,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let e=r.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;r.path=t.reverse().join(":")}return r}(void 0,t,e);return l(t,e,n),n}function d(t,e){var n;return null===(n=f[t])||void 0===n?void 0:n[e]}function l(t,e,n){let o=f[t];o||(f[t]=o={}),o[e]=n}function m(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{p(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f&&!1===f.exe(u,c))return;const a=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction):t.parent._exe(p,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;a&&(void 0!==e?a(JSON.parse(t.mockData)):i=function(t){a(t)}),n._exe(p,u,i,t)})}}}function h(t,e,n="runtime"){i.each(t=>m(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>m(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,c){let p;i.each(t=>{void 0!==t.dummyData&&(!p&&(p={}),p[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=p?Object.assign(p,o):o,u[e.id]||(function(e,n=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o=s){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const f=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];f.inst.inputs[t]=[e,c]}r.exe&&r.exe(f.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,e)})}let y=new WeakMap;function _(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?p(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?p(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=y.get(t);e||y.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function x(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{h(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>m(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>m(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>_(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>_(t,e,n));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:p,coms:f}=i[c];t.comAry.forEach(t=>{f.push(t.runtime.id),"function"!=typeof t._exe&&(h(t,e,n),t._exe(p,u,void 0,void 0))})},o._exe=function(r,u,c=s,p,f){if(!r){if(t.parent){const e=d(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let m=!1;if(i[l]){const e=i[l].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(m=!0)}if(!i[l]||m){let u,a;if(o._exeAsRoot_=!!f,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(p="string"==typeof p?p:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&h(t,e,n),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:_}=i[l];if("input"==(p="string"==typeof p?p:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(_,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=y.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,_)}),_}if(p.match(/^(output)|(inner-input)$/gi)){let e=_;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let g,v,P,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),x(t,e,n),E={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(O[t.toLowerCase()]=e)},run(e=t,n){if("stop"===I&&(f={}),function(t){return Object.assign(w,t||{}),v=[],P=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}e(g)}function e(n){if("stop"==I||n!==g)return;let o;"pause"==I&&setTimeout(e,1e3),P.length>0?o=P.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>e(n))}I="running",g=u(),e(g),new Promise((t,e)=>{})}(),t=>e._exe(void 0,t,void 0,"input",!0)},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,P=void 0,f={},t}}}function N(){return I="pause",!0}function M(t,e){const n={_all:{},_waiting:{},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u(),r={};return{inputs:new Proxy({},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:function(t){n.set(e,(function(n){const o=r[e];if(void 0!==n&&o){r[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,u){r[o]=i;const s=n.get(o);return s?((null==e?void 0:e.input)&&e.input(),s(i)):n.waiting(o,i),!0}}),outputs:new Proxy({},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},c=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!c)throw new Error(`No output(hostId=${r}) found.`);Promise.resolve().then(()=>{(null==e?void 0:e.output)&&e.output(n),c._exe(null,n,u,t)})}}}})}}}])},function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"T_Scope",(function(){})),n.d(e,"compile",(function(){return A})),n.d(e,"createIO",(function(){return M})),n.d(e,"E_ItemType",(function(){return o})),n.d(e,"isTypeof",(function(){return r})),n.d(e,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=n(0);function p(t){let e=t;e._exe||(e._exe=function(n,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const n=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(n,i,r,u)})}let f;function a(t,e){const n=function t(e,n,o,i){let r={id:u(),instId:n,hostId:o,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,n,o,i){const u=t(r,e,o,i);let s=r.comInsts[e];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(e,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let e=r.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;r.path=t.reverse().join(":")}return r}(void 0,t,e);return l(t,e,n),n}function d(t,e){var n;return null===(n=f[t])||void 0===n?void 0:n[e]}function l(t,e,n){let o=f[t];o||(f[t]=o={}),o[e]=n}function m(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{p(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f&&!1===f.exe(u,c))return;const a=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction):t.parent._exe(p,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;a&&(void 0!==e?a(JSON.parse(t.mockData)):i=function(t){a(t)}),n._exe(p,u,i,t)})}}}function h(t,e,n="runtime"){i.each(t=>m(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>m(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,c){let p;i.each(t=>{void 0!==t.dummyData&&(!p&&(p={}),p[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=p?Object.assign(p,o):o,u[e.id]||(function(e,n=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o=s){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const f=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];f.inst.inputs[t]=[e,c]}r.exe&&r.exe(f.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,e)})}let y=new WeakMap;function _(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?p(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?p(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=y.get(t);e||y.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function x(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{h(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>m(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>m(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>_(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>_(t,e,n));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:p,coms:f}=i[c];t.comAry.forEach(t=>{f.push(t.runtime.id),"function"!=typeof t._exe&&(h(t,e,n),t._exe(p,u,void 0,void 0))})},o._exe=function(r,u,c=s,p,f){if(!r){if(t.parent){const e=d(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let m=!1;if(i[l]){const e=i[l].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(m=!0)}if(!i[l]||m){let u,a;if(o._exeAsRoot_=!!f,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(p="string"==typeof p?p:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&h(t,e,n),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:_}=i[l];if("input"==(p="string"==typeof p?p:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(_,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=y.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,_)}),_}if(p.match(/^(output)|(inner-input)$/gi)){let e=_;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let g,v,P,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),x(t,e,n),E={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(O[t.toLowerCase()]=e)},run(e=t,n){if("stop"===I&&(f={}),function(t){return Object.assign(w,t||{}),v=[],P=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}e(g)}function e(n){if("stop"==I||n!==g)return;let o;"pause"==I&&setTimeout(e,1e3),P.length>0?o=P.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>e(n))}I="running",g=u(),e(g),new Promise((t,e)=>{})}(),t=>e._exe(void 0,t,void 0,"input",!0)},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,P=void 0,f={},t}}}function N(){return I="pause",!0}function M(t,e){const n={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:"_setInterseptor"===e?t[e]:function(t){if(r){const n=r[e];"function"==typeof n&&n(t)}n.set(e,(function(n){const o=s[e];if(void 0!==n&&o){s[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=n.get(o);return u?((null==e?void 0:e.input)&&e.input(),u(i)):n.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return n[r];let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},p=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!p)throw new Error(`No output(hostId=${r}) found.`);if((null==e?void 0:e.output)&&e.output(n),c){const t=c[r];"function"==typeof t&&t(n)}p._exe(null,n,u,t)}}}})}}}])},function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"T_Scope",(function(){})),n.d(e,"compile",(function(){return A})),n.d(e,"createIO",(function(){return M})),n.d(e,"E_ItemType",(function(){return o})),n.d(e,"isTypeof",(function(){return r})),n.d(e,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=n(0);function p(t){let e=t;e._exe||(e._exe=function(n,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const n=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(n,i,r,u)})}let f;function a(t,e){const n=function t(e,n,o,i){let r={id:u(),instId:n,hostId:o,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,n,o,i){const u=t(r,e,o,i);let s=r.comInsts[e];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(e,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let e=r.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;r.path=t.reverse().join(":")}return r}(void 0,t,e);return l(t,e,n),n}function d(t,e){var n;return null===(n=f[t])||void 0===n?void 0:n[e]}function l(t,e,n){let o=f[t];o||(f[t]=o={}),o[e]=n}function m(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{p(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f&&!1===f.exe(u,c))return;const a=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction):t.parent._exe(p,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;a&&(void 0!==e?a(JSON.parse(t.mockData)):i=function(t){a(t)}),n._exe(p,u,i,t)})}}}function h(t,e,n="runtime"){i.each(t=>m(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>m(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,c){let p;i.each(t=>{void 0!==t.dummyData&&(!p&&(p={}),p[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=p?Object.assign(p,o):o,u[e.id]||(function(e,n=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o=s){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const f=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];f.inst.inputs[t]=[e,c]}r.exe&&r.exe(f.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,e)})}let y=new WeakMap;function _(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?p(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?p(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=y.get(t);e||y.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function x(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{h(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>m(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>m(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>_(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>_(t,e,n));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:p,coms:f}=i[c];t.comAry.forEach(t=>{f.push(t.runtime.id),"function"!=typeof t._exe&&(h(t,e,n),t._exe(p,u,void 0,void 0))})},o._exe=function(r,u,c=s,p,f){if(!r){if(t.parent){const e=d(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let m=!1;if(i[l]){const e=i[l].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(m=!0)}if(!i[l]||m){let u,a;if(o._exeAsRoot_=!!f,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(p="string"==typeof p?p:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&h(t,e,n),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:_}=i[l];if("input"==(p="string"==typeof p?p:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(_,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=y.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,_)}),_}if(p.match(/^(output)|(inner-input)$/gi)){let e=_;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let g,v,P,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),x(t,e,n),E={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(O[t.toLowerCase()]=e)},run(e=t,n){if("stop"===I&&(f={}),function(t){return Object.assign(w,t||{}),v=[],P=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}e(g)}function e(n){if("stop"==I||n!==g)return;let o;"pause"==I&&setTimeout(e,1e3),P.length>0?o=P.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>e(n))}I="running",g=u(),e(g),new Promise((t,e)=>{})}(),t=>(t&&(t.inputProxies&&e.inputPins&&Object.keys(t.inputProxies).forEach(n=>{(0,t.inputProxies[n])(t=>{const o=e.inputPins.find(t=>t.id===n);o&&o._exe(void 0,t,void 0,void 0)})}),t.outputProxies&&e.outputPins&&e.outputPins.forEach(e=>{const n=t.outputProxies[e.id];"function"==typeof n&&(e.proxyPin={_exe(t,e,o,i){n(e)}})})),e._exe(void 0,null==t?void 0:t.inputParams,void 0,"input",!0))},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,P=void 0,f={},t}}}function N(){return I="pause",!0}function M(t,e){const n={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:"_setInterseptor"===e?t[e]:function(t){if(r){const n=r[e];"function"==typeof n&&n(t)}n.set(e,(function(n){const o=s[e];if(void 0!==n&&o){s[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=n.get(o);return u?((null==e?void 0:e.input)&&e.input(),u(i)):n.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return n[r];let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},p=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!p)throw new Error(`No output(hostId=${r}) found.`);if((null==e?void 0:e.output)&&e.output(n),c){const t=c[r];"function"==typeof t&&t(n)}p._exe(null,n,u,t)}}}})}}}])},function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"T_Scope",(function(){})),n.d(e,"compile",(function(){return A})),n.d(e,"createIO",(function(){return M})),n.d(e,"E_ItemType",(function(){return o})),n.d(e,"isTypeof",(function(){return r})),n.d(e,"UNDEFINED_FRAME_LABEL",(function(){return s})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));const s="UNDEFINED_FRAME_LABEL";var c=n(0);function p(t){let e=t;e._exe||(e._exe=function(n,i,r,u){if(!b())return;const s=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof s._exe){const n=Object(c.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}w.debug&&w.debug.stepTime,s._exe(n,i,r,u)})}let f;function a(t,e){const n=function t(e,n,o,i){let r={id:u(),instId:n,hostId:o,path:void 0,parent:e,returnParams:{},resolve:null,comInsts:{},applyScope(e,n,o,i){const u=t(r,e,o,i);let s=r.comInsts[e];return s&&(!s.scopes&&(s.scopes=[]),s.scopes.push(u)),l(e,o,u),u}};if(i)r.path=r.id;else{const t=[r.id];let e=r.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;r.path=t.reverse().join(":")}return r}(void 0,t,e);return l(t,e,n),n}function d(t,e){var n;return null===(n=f[t])||void 0===n?void 0:n[e]}function l(t,e,n){let o=f[t];o||(f[t]=o={}),o[e]=n}function m(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{p(t)}),t._exe=function(i,u,s,c){if(!b())return;O.execute&&O.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=d(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f&&!1===f.exe(u,c))return;const a=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)t.proxyPin&&t.proxyPin._exe?t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction):t.parent._exe(p,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;a&&(void 0!==e?a(JSON.parse(t.mockData)):i=function(t){a(t)}),n._exe(p,u,i,t)})}}}function h(t,e,n="runtime"){i.each(t=>m(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>m(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,c){let p;i.each(t=>{void 0!==t.dummyData&&(!p&&(p={}),p[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=p?Object.assign(p,o):o,u[e.id]||(function(e,n=s){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o=s){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const f=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];f.inst.inputs[t]=[e,c]}r.exe&&r.exe(f.inst,o,c)},t.frames&&t.frames.forEach(t=>{x(t,e)})}let y=new WeakMap;function _(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?p(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?p(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=y.get(t);e||y.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function x(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{h(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>m(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>m(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>_(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>_(t,e,n));const o=t,i={};o._update=function(o,r,u=s){const c=u+o.id,{curScope:p,coms:f}=i[c];t.comAry.forEach(t=>{f.push(t.runtime.id),"function"!=typeof t._exe&&(h(t,e,n),t._exe(p,u,void 0,void 0))})},o._exe=function(r,u,c=s,p,f){if(!r){if(t.parent){const e=d(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=a(void 0,t.id+"-parent"))}const l=c+r.id;let m=!1;if(i[l]){const e=i[l].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(m=!0)}if(!i[l]||m){let u,a;if(o._exeAsRoot_=!!f,c=void 0!==c?c:s,o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const d=[];"input"==(p="string"==typeof p?p:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,c,t.id,t._rootF),t.comAry.forEach(t=>{d.push(t.runtime.id),"function"!=typeof t._exe&&h(t,e,n),t._exe(a,c,void 0,void 0)})),i[l]={myInstScope:u,curScope:a,coms:d}}const{curScope:_}=i[l];if("input"==(p="string"==typeof p?p:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(_,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=y.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,_)}),_}if(p.match(/^(output)|(inner-input)$/gi)){let e=_;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let g,v,P,E=null,I="stop";function b(){return"running"===I}let w={},O={};function A(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),x(t,e,n),E={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(O[t.toLowerCase()]=e)},run(e=t,n){if("stop"===I&&(f={}),function(t){return Object.assign(w,t||{}),v=[],P=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){O.error?O.error(t):console.error(t)}e(g)}function e(n){if("stop"==I||n!==g)return;let o;"pause"==I&&setTimeout(e,1e3),P.length>0?o=P.shift():v.length>0&&(o=v.shift()),o?w.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o):setTimeout(t=>e(n))}I="running",g=u(),e(g),new Promise((t,e)=>{})}(),t=>(t&&(t.inputs&&e.inputPins&&Object.keys(t.inputs).forEach(n=>{(0,t.inputs[n])(t=>{const o=e.inputPins.find(t=>t.id===n);o&&o._exe(void 0,t,void 0,void 0)})}),t.outputs&&e.outputPins&&e.outputPins.forEach(e=>{const n=t.outputs[e.id];"function"==typeof n&&(e.proxyPin={_exe(t,e,o,i){n(e)}})})),e._exe(void 0,null==t?void 0:t.inputParams,void 0,"input",!0))},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:N,stop(){const t=(I="stop",!0);return E=null,v=void 0,P=void 0,f={},t}}}function N(){return I="pause",!0}function M(t,e){const n={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:"_setInterseptor"===e?t[e]:function(t){if(r){const n=r[e];"function"==typeof n&&n(t)}n.set(e,(function(n){const o=s[e];if(void 0!==n&&o){s[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=n.get(o);return u?((null==e?void 0:e.input)&&e.input(),u(i)):n.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return n[r];let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},p=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!p)throw new Error(`No output(hostId=${r}) found.`);if((null==e?void 0:e.output)&&e.output(n),c){const t=c[r];"function"==typeof t&&t(n)}p._exe(null,n,u,t)}}}})}}}])},function(t,e,n){"use strict";var o,i=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),u=[];function s(t){for(var e=-1,n=0;n<u.length;n++)if(u[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},o=[],i=0;i<t.length;i++){var r=t[i],c=e.base?r[0]+e.base:r[0],p=n[c]||0,f="".concat(c," ").concat(p);n[c]=p+1;var a=s(f),d={css:r[1],media:r[2],sourceMap:r[3]};-1!==a?(u[a].references++,u[a].updater(d)):u.push({identifier:f,updater:y(d,e),references:1}),o.push(f)}return o}function p(t){var e=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var i=n.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(e);else{var u=r(t.insert||"head");if(!u)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");u.appendChild(e)}return e}var f,a=(f=[],function(t,e){return f[t]=e,f.filter(Boolean).join("\n")});function d(t,e,n,o){var i=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=a(e,i);else{var r=document.createTextNode(i),u=t.childNodes;u[e]&&t.removeChild(u[e]),u.length?t.insertBefore(r,u[e]):t.appendChild(r)}}function l(t,e,n){var o=n.css,i=n.media,r=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var m=null,h=0;function y(t,e){var n,o,i;if(e.singleton){var r=h++;n=m||(m=p(e)),o=d.bind(null,n,r,!1),i=d.bind(null,n,r,!0)}else n=p(e),o=l.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<n.length;o++){var i=s(n[o]);u[i].references--}for(var r=c(t,e),p=0;p<n.length;p++){var f=s(n[p]);0===u[f].references&&(u[f].updater(),u.splice(f,1))}n=r}}}},function(t,e,n){(e=n(6)(!1)).push([t.i,".slot-78f44 {\n  width: 100%;\n  height: 100% !important;\n  position: relative !important;\n}\n.lyFlexColumn-bc992 {\n  display: flex;\n  flex-direction: column;\n}\n.lyFlexRow-40836 {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n}\n.justifyContentFlexStart-6e8c3 {\n  justify-content: flex-start;\n}\n.justifyContentFlexCenter-1b2b7 {\n  justify-content: center;\n}\n.justifyContentFlexFlexEnd-bb109 {\n  justify-content: flex-end;\n}\n.justifyContentFlexSpaceAround-bc67b {\n  justify-content: space-around;\n}\n.justifyContentFlexSpaceBetween-2463c {\n  justify-content: space-between;\n}\n.alignItemsFlexStart-297e8 {\n  align-items: flex-start;\n}\n.alignItemsFlexCenter-74c2d {\n  align-items: center;\n}\n.alignItemsFlexFlexEnd-86a8e {\n  align-items: flex-end;\n}\n.debugFocus-417fb {\n  outline: 1px dashed red;\n  outline-offset: -3px;\n}\n",""]),e.locals={slot:"slot-78f44",lyFlexColumn:"lyFlexColumn-bc992",lyFlexRow:"lyFlexRow-40836",justifyContentFlexStart:"justifyContentFlexStart-6e8c3",justifyContentFlexCenter:"justifyContentFlexCenter-1b2b7",justifyContentFlexFlexEnd:"justifyContentFlexFlexEnd-bb109",justifyContentFlexSpaceAround:"justifyContentFlexSpaceAround-bc67b",justifyContentFlexSpaceBetween:"justifyContentFlexSpaceBetween-2463c",alignItemsFlexStart:"alignItemsFlexStart-297e8",alignItemsFlexCenter:"alignItemsFlexCenter-74c2d",alignItemsFlexFlexEnd:"alignItemsFlexFlexEnd-86a8e",debugFocus:"debugFocus-417fb"},t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",o=t[3];if(!o)return n;if(e&&"function"==typeof btoa){var i=(u=o,s=btoa(unescape(encodeURIComponent(JSON.stringify(u)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),r=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[n].concat(r).concat([i]).join("\n")}var u,s,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,o){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(o)for(var r=0;r<this.length;r++){var u=this[r][0];null!=u&&(i[u]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);o&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){"use strict";var o,i;function r(t,e){return t&&"object"==typeof t&&t._type==e}function u(){let t="abcdefhijkmnprstwxyz",e=t.length,n="";for(let o=0;o<6;o++)n+=t.charAt(Math.floor(Math.random()*e));return"u_"+n}n.r(e),n.d(e,"parse",(function(){return N})),n.d(e,"RenderReact",(function(){return T})),function(t){t[t.FRAME=0]="FRAME",t[t.NODE=1]="NODE",t[t.PIN=2]="PIN",t[t.JOINT=3]="JOINT",t[t.CONNECTION=4]="CONNECTION"}(o||(o={})),function(t){t.each=function(t,...e){e.forEach(e=>{e&&e.forEach(t)})},t.find=function(t,...e){let n;return e.find(e=>{if(e)return n=e.find(e=>t(e))}),n}}(i||(i={}));var s=n(3);function c(t){let e=t;e._exe||(e._exe=function(n,i,r,u){if(!v())return;const c=t.finishPin.forkedFrom||t.finishPin;if("function"!=typeof c._exe){const n=Object(s.isTypeof)(t.startPin.parent,o.NODE)?t.startPin.parent:void 0;throw new Error(`连接(来自:${n?n.runtime.title:"未知组件"}，${e.title})已断开.`)}P.debug&&P.debug.stepTime,c._exe(n,i,r,u)})}function p(t,e,n="runtime"){t.conAry&&t.conAry.forEach(t=>{c(t)}),t._exe=function(i,u,s,c){if(!v())return;E.execute&&E.execute(o.PIN,t.id,u);let p=i;if(!p)if(r(t.parent,o.NODE)){const e=t.parent.parent;p=e._scopeManager.getCurrentScope(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}else if(r(t.parent,o.FRAME)){const e=t.parent;p=e._scopeManager.getCurrentScope(!e._exeAsRoot_&&e.parent?e.parent.runtime.id:void 0,e.id)}let f=e.pin?e.pin(t):void 0;if(f){if(!1===f.exe(u,c))return}const a=e=>{f&&f.exe(e,t,"返回"),"function"==typeof s&&s(e)};if("input"==t.direction)if(t.proxyPin&&t.proxyPin._exe){t.proxyPin.parent._exe(p,{[t.hostId]:u},void 0,t.direction)}else t.parent._exe(p,void 0,{[t.hostId]:u},a);else if("inner-input"===t.direction){if(!t.proxyPin||!t.proxyPin._exe)return;t.proxyPin._exe(p.parent,u,a,c)}else if("output"==t.direction||"inner-output"==t.direction)if(t.proxyPin&&t.proxyPin._exe)t.proxyPin._exe(i.parent,u,a,c);else{let e;"mock"===n&&t.mockData&&(e=t.mockData),t.conAry&&t.conAry.length>0&&t.conAry.forEach((n,o)=>{let i;a&&(void 0!==e?a(JSON.parse(t.mockData)):i=function(t){a(t)}),n._exe(p,u,i,t)})}}}function f(t,e,n="runtime"){i.each(t=>p(t,e,n),t.inputPins,t.inputPinExts,t.inputPinsInModel),i.each(t=>p(t,e,n),t.outputPins,t.inputPinExts,t.outputPinsInModel);const o=t,r=e.node(t),u={};o._exe=function(e,n,o,s){let c;i.each(t=>{void 0!==t.dummyData&&(!c&&(c={}),c[t.hostId]=t.dummyData)},t.inputPins,t.inputPinsInModel),o=c?Object.assign(c,o):o,u[e.id]||(!function(e,n="UNDEFINED_FRAME_LABEL"){if("function"!=typeof r.render)throw new Error("Render config function for node not found.");const o=e.path,i={};t.frames&&t.frames.forEach(t=>{i[t.id]=function(n,o="UNDEFINED_FRAME_LABEL"){const i=t._exe(e,n,o);if(i)return i.path}});const u={inst:r.render(o,n,i,e),scopes:[]};e.comInsts[t.runtime.id]=u}(e,n),u[e.id]=!0);const p=e.comInsts[t.runtime.id];if(o)for(let t in o){const e=o[t];p.inst.inputs[t]=[e,s]}r.exe&&r.exe(p.inst,o,s)},t.frames&&t.frames.forEach(t=>{m(t,e)})}let a=new WeakMap;function d(t,e,n="runtime"){const o=t.parent.parent.runtime;t.from?c(t.from):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`),t.to?c(t.to):console.warn(`组件(${o.title},${o.def.namespace})存在连接断开.`);t._exe=function(n,o,i){const r=e.joint?e.joint(t):void 0,u=t.parent.parent;if("input"==t.type){let e=n.comInsts[u.runtime.id].scopes.find(e=>e.hostId===t.parent.id);const s=e=>{r&&r.exe(o),t.to&&t.to._exe(e,o,i,t.type)};if(e){let t=e.hostId;e.parent.comInsts[u.runtime.id].scopes.forEach(e=>{e.hostId==t&&s(e)})}else{let e=a.get(t);e||a.set(t,e=new WeakMap);let o=e.get(n);o||e.set(n,o=[]),o.push(s)}}else r&&"function"==typeof r.exe&&r.exe(o),t.to&&t.to._exe(n.parent,o,i,t.type)}}function l(){let t;function e(e,n,o){let i=t[e];i||(t[e]=i={}),i[n]=o}return{applyScope(t,n){const o=function t(n,o,i,r){let s={id:u(),instId:o,hostId:i,path:void 0,parent:n,returnParams:{},resolve:null,comInsts:{},applyScope(n,o,i,r){const u=t(s,n,i,r);let c=s.comInsts[n];return c&&(!c.scopes&&(c.scopes=[]),c.scopes.push(u)),e(n,i,u),u}};if(r)s.path=s.id;else{const t=[s.id];let e=s.parent;for(;e;)e.parent&&t.push(e.id),e=e.parent;s.path=t.reverse().join(":")}return s}(void 0,t,n);return e(t,n,o),o},getCurrentScope(e,n){var o;return null===(o=t[e])||void 0===o?void 0:o[n]},start(){t={}},stop(){t={}}}}function m(t,e,n="runtime"){t.comAry&&t.comAry.forEach(t=>{f(t,e,n)}),t.inputPins&&t.inputPins.forEach(t=>p(t,e,n)),t.outputPins&&t.outputPins.forEach(t=>p(t,e,n)),t.inputJoints&&t.inputJoints.forEach(t=>d(t,e,n)),t.outputJoints&&t.outputJoints.forEach(t=>d(t,e,n));const o=t,i={};o._startScope=function(){this._scopeManager=l(),this._scopeManager.start()},o._clearScope=function(){this._scopeManager&&(this._scopeManager.stop(),this._scopeManager=void 0)},o._update=function(o,r,u="UNDEFINED_FRAME_LABEL"){const s=u+o.id,{curScope:c,coms:p}=i[s];t.comAry.forEach(t=>{p.push(t.runtime.id),"function"!=typeof t._exe&&(f(t,e,n),t._exe(c,u,void 0,void 0))})},o._exe=function(r,u,s="UNDEFINED_FRAME_LABEL",c,p){if(!r){if(t.parent){const e=o._scopeManager.getCurrentScope(t.parent?t.parent.runtime.id:t.id,t.id);e&&(r=e.parent)}r||(r=o._scopeManager.applyScope(void 0,t.id+"-parent"))}const d=s+r.id;let l=!1;if(i[d]){const e=i[d].coms;(e.length!==t.comAry.length||t.comAry.find(t=>e.indexOf(t.runtime.id)<0))&&(l=!0)}if(!i[d]||l){let u,a;if(o._exeAsRoot_=!!p,s=void 0!==s?s:"UNDEFINED_FRAME_LABEL",o._exeAsRoot_)u={inst:void 0,scopes:[]};else if(u=r.comInsts[t.parent.runtime.id],!u&&t._rootF)return;const l=[];"input"==(c="string"==typeof c?c:"input")&&(a=r.applyScope(!o._exeAsRoot_&&t.parent?t.parent.runtime.id:void 0,s,t.id,t._rootF),t.comAry.forEach(t=>{l.push(t.runtime.id),"function"!=typeof t._exe&&f(t,e,n),t._exe(a,s,void 0,void 0)})),i[d]={myInstScope:u,curScope:a,coms:l}}const{curScope:m}=i[d];if("input"==(c="string"==typeof c?c:"input")){const e={};if("mock"===n&&t.inputPins.length>0&&t.inputPins.forEach(t=>{t.mockData&&(e[t.hostId]=t.mockData)}),u=Object.assign(e,u))for(let e in u){const n=t.inputPins.find(t=>t.hostId==e);n?n._exe(m,u[e],void 0,void 0):"undefined"!=typeof console&&"function"==typeof console.error&&console.error(`No inputPin(id=${e}) found`)}return t.inputJoints&&t.inputJoints.forEach(t=>{!function(t,e){let n=e.parent,o=a.get(t);if(o){let t=o.get(n);t&&t.forEach(t=>{t(e)})}}(t,m)}),m}if(c.match(/^(output)|(inner-input)$/gi)){let e=m;if(t.outputPins.length){if(u)for(let t in u)e.returnParams[t]=u[t]||null;t.outputPins.find(t=>null==e.returnParams[t.hostId])||e.resolve()}}}}let h,y,_,x=null;let g="stop";function v(){return"running"===g}let P={},E={};function I(t,e,n="runtime"){return function(t,e){if(!r(t,e))throw new Error("Invalid item type")}(t,o.FRAME),m(t,e,n),x={on(t,e){t&&"string"==typeof t&&"function"==typeof e&&(E[t.toLowerCase()]=e)},run(e=t,n){if(e._startScope(),function(t){return Object.assign(P,t||{}),y=[],_=[],!0}(n))return function(){function t(t){try{t.exe&&t.exe()}catch(t){E.error?E.error(t):console.error(t)}e(h)}function e(n){if("stop"==g||n!==h)return;let o;if("pause"==g&&setTimeout(e,1e3),_.length>0?o=_.shift():y.length>0&&(o=y.shift()),o){P.debug?setTimeout(()=>{t(o)},o.debugSleep):"number"==typeof o.sleep&&o.sleep>-1?setTimeout(()=>{t(o)},0):t(o)}else setTimeout(t=>e(n))}g="running",h=u(),e(h),new Promise((t,e)=>{})}(),t=>{t&&t.outputs&&e.outputPins&&e.outputPins.forEach(e=>{const n=t.outputs[e.id];"function"==typeof n&&(e.proxyPin={_exe(t,e,o,i){n(e)}})});const n=e._exe(void 0,null==t?void 0:t.inputParams,void 0,"input",!0);return t.inputs&&e.inputPins&&Object.keys(t.inputs).forEach(n=>{const o=t.inputs[n],i=e.inputPins.find(t=>t.id===n);i&&i.conAry.length>0&&o(t=>{i._exe(void 0,t,void 0,void 0)})}),n}},update:(e,n=t)=>(n._update(e,void 0,void 0),!0),pause:b,stop(){const e=(g="stop",!0);return x=null,y=void 0,_=void 0,t._clearScope(),e}}}function b(){return g="pause",!0}let w,O,A;function N(t){const e=JSON.parse(JSON.stringify(t));A=new WeakMap,O={};const n=e["xg.desn.stageview"],{def:i,refs:u}=n;w=u;const s=[],c=M(i._ref_).mainModule;if(c.frame){!function t(e){e.comAry&&e.comAry.forEach(e=>{if(r(e,o.NODE)){const{runtime:n}=e,o=n.def.namespace+"@"+n.def.version;s.indexOf(o)<=0&&s.push(o),e.frames&&e.frames.forEach(e=>t(e))}})}(c.frame)}return w=void 0,O=void 0,A=void 0,{mainModule:c,requireComs:s}}function M(t){let e=O[t];return e||(O[t]=e=w[t],function t(e){if(e&&A.has(e))return A.get(e);if("object"==typeof e&&e){let n;return e._ref_?(n=M(e._ref_),A.set(e,n)):(A.set(e,e),Object.keys(e).forEach(n=>{let o=e[n];Array.isArray(o)?o.forEach((e,n)=>{o[n]=t(e)}):e[n]=t(o)}),n=e),n}return e}(e),e)}var j=n(2),F=n(1),S=n(0),D=n.n(S);function T({mainModule:t,comDefs:e,inputParams:n,inputs:o,outputs:r,env:s,runtimeCfg:c,logs:p,logger:f=(()=>{})}){const a=Object.assign({},e),d=Object(j.useMemo)(()=>({}),[]),{frame:l,slot:m}=Object(j.useMemo)(()=>{const{frame:e,slot:l}=Object(F.observable)(t);return I(e,{node:t=>({render(e,n,o,r){const p=function(t,e){const n={_all:{},_waiting:{},has(t){return"function"==typeof this._all[t]},set(t,e){this._all[t]=e;const n=this._waiting[t];if(n)try{n.forEach(t=>{e(t)}),delete this._waiting[t]}finally{}return!0},get(t){return this._all[t]},waiting(t,e){let n=this._waiting[t];n||(n=this._waiting[t]=[]),n.push(e)}},o=u();let r;const s={};let c;return{inputs:new Proxy({_setInterseptor(t){r=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.inputPins,t.inputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get:(t,e,i)=>"__id__"===e?o:"_setInterseptor"===e?t[e]:function(t){if(r){const n=r[e];"function"==typeof n&&n(t)}n.set(e,(function(n){const o=s[e];if(void 0!==n&&o){s[e]=void 0;const[o,i]=n;t(o,(function(t){"function"==typeof i&&i(t)}))}}))},set(t,o,i,r){s[o]=i;const u=n.get(o);return u?((null==e?void 0:e.input)&&e.input(),u(i)):n.waiting(o,i),!0}}),outputs:new Proxy({_setInterseptor(t){c=t}},{ownKeys(e){const n=[];return i.each(t=>{n.push(t.hostId)},t.outputPins,t.outputPinsInModel),n},getOwnPropertyDescriptor:t=>({enumerable:!0,configurable:!0}),get(n,r,u){if("__id__"===r)return o;if("_setInterseptor"===r)return n[r];let s;return function(n,o){if(t.outputPins){s=o;const u=function(t){"function"==typeof s&&s(t)},p=i.find(({hostId:t})=>r==t,t.outputPins,t.outputPinsInModel);if(!p)throw new Error(`No output(hostId=${r}) found.`);if((null==e?void 0:e.output)&&e.output(n),c){const t=c[r];"function"==typeof t&&t(n)}p._exe(null,n,u,t)}}}})}}(t,{output(){}});d[t.runtime.id]={scopePath:e,frameLable:n,frames:o,io:p};const l=t.runtime.def,m=l.rtType;if(m&&m.match(/js/gi)){const e=Object.assign({get curModule(){if(t.parent.parent){const e=t.parent.outputPins,n={};return e.forEach(t=>{n[t.id]=(e,n)=>{t._exe(r,e,n)}}),{outputs:n}}}},c),n=l.namespace+"@"+l.version,o=a[n];if(!o||"function"!=typeof o)throw new Error(`未找到组件(${n})`);o({data:Object(F.clone)(t.runtime.model.data),inputs:p.inputs,outputs:p.outputs,env:Object.assign({runtime:e},s||{}),logger:f(t.runtime)})}return p}}),pin(t){const e=t.parent.runtime?t.parent.runtime:void 0;return{exe(n){t.type.match(/^ext$/gi)&&t.direction.match(/^input|inner-output$/gi)&&("show"===t.hostId?t.parent.runtime.model.style.display="block":"hide"===t.hostId&&(t.parent.runtime.model.style.display="none"));const o="object"==typeof n&&n?JSON.stringify(n):String(n);e&&p&&"function"==typeof p.info&&setTimeout(n=>{p.info({catelog:"程序运行",content:`${e.title} | ${t.title} ${"input"==t.direction||"inner-input"==t.direction?"传入":"传出"} ${o}`,focus(){e._focus=!0},blur(){e._focus=void 0}})})}}}}).run()({inputParams:n?{params:n}:void 0,inputs:o,outputs:r}),{frame:e,slot:l}},[]),h=[],y=Object(F.uuid)();return m.comAry.forEach(t=>{h.push(React.createElement(R,{key:y+t.runtime.id,node:t,comDefs:a,env:s,runtimeCfg:c,logger:f,rtMaps:d}))}),h}function R({node:t,comDefs:e,env:n,runtimeCfg:o,logger:i,slotIo:r,rtMaps:u}){const{slots:s,runtime:c,parent:p}=t,f=c.def.rtType;if(f&&f.match(/js/gi))return;const a=c.model,d=e[c.def.namespace+"@"+c.def.version],l=u[c.id],{inputs:m,outputs:h}=l.io;m&&"function"==typeof m._setInterseptor&&(null==r?void 0:r.inputs)&&m._setInterseptor(r.inputs),h&&"function"==typeof h._setInterseptor&&(null==r?void 0:r.outputs)&&h._setInterseptor(r.outputs);const y={};s&&s.forEach(t=>{y[t.id]={id:t.id,title:t.title,render(...r){const{frames:s}=u[c.id],p=s[t.id];"function"==typeof p&&p();const f=t.comAry;return React.createElement("section",{className:C(t),style:{overflow:"hidden"}},f.map(t=>React.createElement(R,{slotIo:r[0],key:t.runtime.id,node:t,comDefs:e,env:n,runtimeCfg:o,logger:i,rtMaps:u})))},size:()=>t.comAry.length}});const _=a.style;let x={};"absolute"===p.style.layout&&(x.position="absolute",x.top=_.top+"px",x.left=_.left+"px");const g={};_.marginTop<0?g.marginTop=_.marginTop+"px":g.paddingTop=_.marginTop+"px",_.marginBottom<0?g.marginBottom=_.marginBottom+"px":g.paddingBottom=_.marginBottom+"px";const v=Object.assign({runtime:o||{}},n||{});return React.createElement("div",{id:t.runtime.id,style:Object.assign(Object.assign({width:_.width||"100%",display:_.display,overflow:"hidden",paddingLeft:_.marginLeft+"px",paddingRight:_.marginRight+"px",position:_.position||"relative"},g),x),className:""+(t.runtime._focus?D.a.debugFocus:"")},d({slots:y,env:v,data:a.data,title:t.runtime.title,style:_,inputs:m,outputs:h,logger:i(t.runtime)}))}function C(t){var e,n;const o=[D.a.slot],i=t.style;if(i){"flex-column"==(null===(e=i.layout)||void 0===e?void 0:e.toLowerCase())?o.push(D.a.lyFlexColumn):"flex-row"==(null===(n=i.layout)||void 0===n?void 0:n.toLowerCase())&&o.push(D.a.lyFlexRow);const t=i.justifyContent;t&&("FLEX-START"===t.toUpperCase()?o.push(D.a.justifyContentFlexStart):"CENTER"===t.toUpperCase()?o.push(D.a.justifyContentFlexCenter):"FLEX-END"===t.toUpperCase()?o.push(D.a.justifyContentFlexFlexEnd):"SPACE-AROUND"===t.toUpperCase()?o.push(D.a.justifyContentFlexSpaceAround):"SPACE-BETWEEN"===t.toUpperCase()&&o.push(D.a.justifyContentFlexSpaceBetween));const r=i.alignItems;r&&("FLEX-START"===r.toUpperCase()?o.push(D.a.alignItemsFlexStart):"CENTER"===r.toUpperCase()?o.push(D.a.alignItemsFlexCenter):"FLEX-END"===r.toUpperCase()&&o.push(D.a.alignItemsFlexFlexEnd))}return o.join(" ")}}])}));